---
import { ExternalLinkIcon, WrenchIcon } from "lucide-preact";
import SectionTitle from "./SectionTitle.astro";
import { Image } from "astro:assets";

// Lazy loading ProjectInfo
const { ProjectsList } = await import("../lib/ProjectsList");
---

<section
    id="projects"
    class="w-full min-h-screen px-6 py-4 pt-14 bg-background"
>
    <SectionTitle title="My Projects">
        <div
            class="Fade_Up relative w-full grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 lg:px-12 pb-6 py-20"
        >
            {
                ProjectsList?.map((project) => {
                    if (project?.hideProject) return;

                    return (
                        <div class="Project_Stagger Card_Main w-full h-fit flex_center flex-col bg-cardGradient overflow-hidden rounded-[0.4em] mt-3 border-2 border-border hover:border-transparent hover:shadow-[0_0_20px_rgba(123,97,255,0.5)] transition-all duration-300 relative before:absolute before:inset-0 before:rounded-[0.4em] before:p-0.5 before:bg-gradient-vibrant before:opacity-0 hover:before:opacity-100 before:transition-opacity before:-z-10">
                            <a 
                                href={project.Source}
                                target="_blank"
                                rel="noreferrer"
                                class="Projects_Preview w-full relative rounded-[0.4em] cursor-pointer block"
                                title={`View ${project.Name} on GitHub`}
                            >
                                <Image
                                    class="Card_Image bg-cover transition-opacity w-full"
                                    style={{
                                        borderRadius: "0.4em 0.4em 0 100%",
                                    }}
                                    src={project.Shot}
                                    alt={`Project_ScreenShot_${project.Name}`}
                                    widths={[346, project.Shot.width]}
                                    sizes={`(max-width: 720px) 346px, ${project.Shot.width}px`}
                                    loading="lazy"
                                />
                                <Image
                                    class="absolute left-6 bottom-6"
                                    src={project.Logo}
                                    alt={`Project_Logo_${project.Name}`}
                                    width={project.LogoSize}
                                    height={project.LogoSize}
                                    loading="lazy"
                                />
                            </a>
                            <div class="w-full text-[0.95em] px-4">
                                <div class="flex justify-between items-center">
                                    <h3 class="font-mono text-[1.4em] py-3">
                                        {project.Name}
                                    </h3>
                                    <div class="flex">
                                        {project.Status === "development" && (
                                            <div class="flex_center gap-2 px-1 py-0.5 text-orange-400">
                                                <WrenchIcon size={16} />

                                                <span class="text-[0.8em]">
                                                    Under Development
                                                </span>
                                            </div>
                                        )}

                                        <a
                                            href={project.Source}
                                            title={`${project.Name} Repository`}
                                            target="_blank"
                                            rel="noreferrer"
                                            class="Projects_Link flex"
                                        >
                                            <ExternalLinkIcon aria-hidden="true" />
                                            <span class="sr-only">
                                                GitHub Repository for {project.Name}
                                            </span>
                                        </a>
                                    </div>
                                </div>
                                <p class="text-left font-mono">{project.ShortDesc}</p>

                                <div class="w-full flex items-center gap-4 py-3">
                                    {project.Tech.map((tech) => {
                                        return (
                                            <Image
                                                src={tech.icon}
                                                alt={`TechIcon ${tech.title}`}
                                                width={40}
                                                height={40}
                                                loading="lazy"
                                            />
                                        );
                                    })}
                                </div>
                            </div>
                        </div>
                    );
                })
            }
        </div>
    </SectionTitle>
</section>
